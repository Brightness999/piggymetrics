/** * Registration form */$('#signup').submit(function(e) {	e.preventDefault();	// submit form	if (!$("input[name='ghauth']").val() && $("input[id='backloginform']").val() && $("input[id='backpasswordform']").val()) {		var regOptions = {			resetForm: 	false,			data: 		{ avatar: userpic.match(re)[1]},			datatype: 	"json",			success: 	function(reply) {				// If registration failed				if (reply.state == 'fail' && reply.message) {					alert(reply.message);				}				// If registration ok				else {					$('#registrationforms, .fliptext, #createaccount').fadeOut(300);					$('#mailform').fadeIn(500);					setTimeout(function(){ $("#backmailform").focus() }, 10);					jsonParse(reply);				}			}		};		$("#signup").ajaxSubmit(regOptions);	}	else alert(language.fillall);});/** * E-mail form */$('#mail').submit(function(e) {	// turn off default submitting	e.preventDefault();	if (!$("input[name='ghauth']").val() && $("input[name='email']").val()) {	// submit form		var mailOptions = {			resetForm: 	false,			datatype: 	"json",			success: 	function(reply) {				// Show fail message				if (reply.state == 'fail') {					alert(reply.message);				}				// Launch app				else {					setTimeout(initGreetingPage, 200);					setTimeout(function(){ $('#backmailform').val(''); $("#lastlogo").show(); }, 300);				}			}		};		$("#mail").ajaxSubmit(mailOptions);	}});$("#skipmail").bind("click", function(){	$("#lastlogo").show();	setTimeout(initGreetingPage, 300);});/** * Process input data */function processInput() {	$("#piggy").toggleClass("loadingspin");	$("#secondenter").hide();	$("#preloader, #lastlogo").show();	if (!$("input[name='ghauth']").val()) { // if ghost field is empty		// AJAX login form		var loginOptions = {			resetForm: 	true,			datatype: 	"json",			error:  function() {				$("#preloader, #enter, #secondenter").hide();				flipForm();				$('.frontforms').val('');				$("#frontloginform").focus();				alert(language.login_fail);			},			success: function(data) {				jsonParse(data);				console.log(data);				var userAvatar = $("<img />").attr("src","images/userpic.jpg");				$(userAvatar).load(function() {					setTimeout(initGreetingPage, 500);				});			}		};		$("#auth").ajaxSubmit(loginOptions);	}}/** * Login form effects */function initialShaking(){	autoShake();	setTimeout(autoShake, 1900);}function autoShake() {	$("#piggy").toggleClass("auto-shake");}function OnHoverShaking() {	hoverShake();	setTimeout(hoverShake, 1700);}function hoverShake() {	$("#piggy").toggleClass("hover-shake");}function toggleInfo() {	$("#infopage").toggle();}function flipForm() {	$("#cube").toggleClass("flippedform");	$("#frontpasswordform").focus();}$("#piggy").on("click mouseover", function(){	if ($(this).hasClass("skakelogo") === false && $(this).hasClass("hover-shake") === false) {		OnHoverShaking();	}});$(".fliptext").bind("click", function(){	setTimeout( function() { $("#plusavatar").addClass("avataranimation"); } , 1000);	$("#flipper").toggleClass("flippedcard");});$(".flipinfo").on("click", function() {	$("#flipper").toggleClass("flippedcardinfo");	toggleInfo();});$(".frominfo, #infotitle, #infosubtitle").on("click", function() {	$("#flipper").toggleClass("flippedcardinfo");	setTimeout(toggleInfo, 400);});$("#enter").on("click", function() {flipForm()});$("#secondenter").on("click", function() {processInput()});$("#frontloginform").keyup(function (e) {	if( $(this).val().length >= 3 ) {		$("#enter").show();		if (e.which == 13) {			flipForm();			$("#enter").hide();		}		return;	} else {		$("#enter").hide();	}});$("#frontpasswordform").keyup(function(e) {	if ( $(this).val().length >= 6) {		$("#secondenter").show();		if(e.which == 13) {			$(this).blur();			processInput();		}		return;	} else {		$("#secondenter").hide();	}});